import requests
import re
from requests.packages.urllib3.exceptions import InsecureRequestWarning

# Suppress the warning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

# Specify the URL
URL_TEMPLATE = "https://{}/webui/logoutconfirm.html?logon_hash=1"

# Specify the file path
file_path = "url_list.txt"

# Define a RE pattern to check for hexadecimal values
hexadecimal_pattern = r'[0-9A-Fa-f]+'

try:
    # Open and read the TXT file to get url's
    with open(file_path, 'r') as file:
        domains = [line.strip() for line in file.readlines()]

    for domain in domains:
        # Substitute the url's into the URL template
        URL = URL_TEMPLATE.format(domain)

        # Perform the POST request using requests
        response = requests.post(URL, verify=False)

        # Output the domain, response content, and "Exploited" on the same line
        print(f"Domain: {domain} - Response: {response.text}", end=' ')
        if response.text:  # Check if the response is not empty
            if re.search(hexadecimal_pattern, response.text):
                print("Exploited", end=' ')
        print("=" * 20)  # Separate responses with a line
except FileNotFoundError:
    print(f"File not found: {file_path}")
except Exception as e:
    print(f"An error occurred: {e}")
